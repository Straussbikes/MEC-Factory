{"ast":null,"code":"import { defineStore } from \"pinia\";\nimport { ref } from \"vue\";\nimport axios from \"axios\";\nexport const useUserStore = defineStore(\"user\", () => {\n  const token = ref(\"null\");\n  const expiresIn = ref(\"null\");\n  const data = ref(\"null\");\n  const isLoggedIn = ref(localStorage.getItem('isLoggedIn') === 'true' || false);\n  const name = ref(\"null\");\n  const tableData = [];\n  const setTime = () => {\n    setTimeout(() => {\n      refreshToken();\n    }, expiresIn.value * 1000 - 6000);\n  };\n  const logout = async () => {\n    try {\n      const email = localStorage.getItem(\"emaila\");\n      const response = await axios.get(\"/logout\", {\n        params: {\n          email: email\n        }\n      });\n      console.log(response);\n    } catch (error) {\n      console.log(error);\n    } finally {\n      resetStore();\n    }\n  };\n  const refreshToken = async () => {\n    try {\n      const res = await axios.get(\"/refresh\");\n      token.value = res.data.token;\n      expiresIn.value = res.data.expiresIn;\n      setTime();\n    } catch (error) {\n      console.log(error);\n    }\n  };\n  const resetStore = () => {\n    token.value = null;\n    expiresIn.value = null;\n    isLoggedIn.value = false;\n    localStorage.removeItem('tableData');\n    localStorage.removeItem('isLoggedIn');\n    localStorage.removeItem('name');\n    localStorage.removeItem('emaila');\n  };\n  return {\n    tableData,\n    data,\n    token,\n    expiresIn,\n    isLoggedIn,\n    name,\n    setTime,\n    refreshToken,\n    logout\n  };\n});","map":{"version":3,"names":["defineStore","ref","axios","useUserStore","token","expiresIn","data","isLoggedIn","localStorage","getItem","name","tableData","setTime","setTimeout","refreshToken","value","logout","email","response","get","params","console","log","error","resetStore","res","removeItem"],"sources":["/home/bikes/Desktop/MECGIT/MEC-Factory/frontend/src/services/user-store.js"],"sourcesContent":["import {defineStore} from \"pinia\";\nimport {ref} from \"vue\";\nimport axios from \"axios\";\n\nexport const useUserStore = defineStore(\"user\",() => {\n    const token = ref(\"null\");\n    const expiresIn = ref(\"null\");\n    const data=ref(\"null\")\n    const isLoggedIn = ref(localStorage.getItem('isLoggedIn') === 'true' || false);\n    const name=ref(\"null\");\n    const tableData=[];\n    const setTime =() =>{\n        setTimeout(() =>{\n          refreshToken()\n        },expiresIn.value*1000 -6000)\n      };\n\n    const logout  = async () => {\n        try {\n         const email = localStorage.getItem(\"emaila\");\n         const response =await axios.get(\"/logout\",{params:{email:email}});\n         console.log(response)\n        } catch (error) {\n            console.log(error);\n        } finally{\n            resetStore();\n        }\n    };\n     \n    const refreshToken =  async () =>{\n        try {\n          const res = await axios.get(\"/refresh\");\n          token.value = res.data.token;\n          expiresIn.value=res.data.expiresIn;\n          setTime();\n        } catch (error) {\n          console.log(error);\n        }\n      };\n   \n    const resetStore = () =>{\n         token.value = null;\n         expiresIn.value=null;\n         isLoggedIn.value = false;\n         localStorage.removeItem('tableData')\n         localStorage.removeItem('isLoggedIn');\n         localStorage.removeItem('name');\n         localStorage.removeItem('emaila');\n         \n    };\n   \n    return {\n        tableData,\n        data,\n        token,\n        expiresIn,\n        isLoggedIn,\n        name,\n        setTime,\n        refreshToken,\n        logout,\n       \n        \n        \n    };\n});"],"mappings":"AAAA,SAAQA,WAAW,QAAO,OAAO;AACjC,SAAQC,GAAG,QAAO,KAAK;AACvB,OAAOC,KAAK,MAAM,OAAO;AAEzB,OAAO,MAAMC,YAAY,GAAGH,WAAW,CAAC,MAAM,EAAC,MAAM;EACjD,MAAMI,KAAK,GAAGH,GAAG,CAAC,MAAM,CAAC;EACzB,MAAMI,SAAS,GAAGJ,GAAG,CAAC,MAAM,CAAC;EAC7B,MAAMK,IAAI,GAACL,GAAG,CAAC,MAAM,CAAC;EACtB,MAAMM,UAAU,GAAGN,GAAG,CAACO,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC,KAAK,MAAM,IAAI,KAAK,CAAC;EAC9E,MAAMC,IAAI,GAACT,GAAG,CAAC,MAAM,CAAC;EACtB,MAAMU,SAAS,GAAC,EAAE;EAClB,MAAMC,OAAO,GAAEA,CAAA,KAAK;IAChBC,UAAU,CAAC,MAAK;MACdC,YAAY,EAAE;IAChB,CAAC,EAACT,SAAS,CAACU,KAAK,GAAC,IAAI,GAAE,IAAI,CAAC;EAC/B,CAAC;EAEH,MAAMC,MAAM,GAAI,MAAAA,CAAA,KAAY;IACxB,IAAI;MACH,MAAMC,KAAK,GAAGT,YAAY,CAACC,OAAO,CAAC,QAAQ,CAAC;MAC5C,MAAMS,QAAQ,GAAE,MAAMhB,KAAK,CAACiB,GAAG,CAAC,SAAS,EAAC;QAACC,MAAM,EAAC;UAACH,KAAK,EAACA;QAAK;MAAC,CAAC,CAAC;MACjEI,OAAO,CAACC,GAAG,CAACJ,QAAQ,CAAC;IACtB,CAAC,CAAC,OAAOK,KAAK,EAAE;MACZF,OAAO,CAACC,GAAG,CAACC,KAAK,CAAC;IACtB,CAAC,SAAQ;MACLC,UAAU,EAAE;IAChB;EACJ,CAAC;EAED,MAAMV,YAAY,GAAI,MAAAA,CAAA,KAAW;IAC7B,IAAI;MACF,MAAMW,GAAG,GAAG,MAAMvB,KAAK,CAACiB,GAAG,CAAC,UAAU,CAAC;MACvCf,KAAK,CAACW,KAAK,GAAGU,GAAG,CAACnB,IAAI,CAACF,KAAK;MAC5BC,SAAS,CAACU,KAAK,GAACU,GAAG,CAACnB,IAAI,CAACD,SAAS;MAClCO,OAAO,EAAE;IACX,CAAC,CAAC,OAAOW,KAAK,EAAE;MACdF,OAAO,CAACC,GAAG,CAACC,KAAK,CAAC;IACpB;EACF,CAAC;EAEH,MAAMC,UAAU,GAAGA,CAAA,KAAK;IACnBpB,KAAK,CAACW,KAAK,GAAG,IAAI;IAClBV,SAAS,CAACU,KAAK,GAAC,IAAI;IACpBR,UAAU,CAACQ,KAAK,GAAG,KAAK;IACxBP,YAAY,CAACkB,UAAU,CAAC,WAAW,CAAC;IACpClB,YAAY,CAACkB,UAAU,CAAC,YAAY,CAAC;IACrClB,YAAY,CAACkB,UAAU,CAAC,MAAM,CAAC;IAC/BlB,YAAY,CAACkB,UAAU,CAAC,QAAQ,CAAC;EAEtC,CAAC;EAED,OAAO;IACHf,SAAS;IACTL,IAAI;IACJF,KAAK;IACLC,SAAS;IACTE,UAAU;IACVG,IAAI;IACJE,OAAO;IACPE,YAAY;IACZE;EAIJ,CAAC;AACL,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}